<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TRUSTNET 2026 – Admin Dashboard</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>


<style>
*{box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{margin:0;background:#eef1f6;padding:40px}

.top-header{
  background:#fff;height:80px;display:flex;
  justify-content:space-between;align-items:center;
  padding:0 40px;box-shadow:0 4px 15px rgba(0,0,0,.08);
  margin:-40px -40px 40px
}
.logout{color:#2563EB;font-weight:700;text-decoration:none}

.admin-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:40px}
.full-width{grid-column:1/-1}

.card{
  background:#fff;border-radius:16px;padding:30px;
  box-shadow:0 15px 40px rgba(0,0,0,.08)
}
.card h2{color:#2563EB;margin:0}
.hr{border-bottom:1px solid #dbeafe;margin:20px 0}

input{width:100%;padding:12px;margin-bottom:12px;border-radius:10px;border:1px solid #ccc}
.btn{background:#2563EB;color:#fff;border:none;padding:10px 22px;border-radius:10px;font-weight:600;cursor:pointer}
.btn-outline{background:#fff;color:#111;border:1px solid #111}

.simple-item{
  display:flex;justify-content:space-between;
  padding:10px 0;border-bottom:1px solid #eee
}
</style>
</head>

<body>

<div class="top-header">
  <h1>TRUSTNET 2026 – Admin Dashboard</h1>
  <a href="#" class="logout" onclick="logout()">LOGOUT</a>
</div>

<div class="admin-grid">

<div class="card">
<h2>Important Dates</h2><div class="hr"></div>
<input id="eventName" placeholder="Event Name">
<input id="eventDate" placeholder="Date">
<button class="btn" onclick="addDate()">Add</button>
<div class="hr"></div><div id="datesList"></div>
</div>

<div class="card">
<h2>Speakers</h2><div class="hr"></div>
<input id="spName" placeholder="Name">
<input id="spAff" placeholder="Affiliation">
<input type="file" id="spImg">
<button class="btn" onclick="addSpeaker()">Add</button>
<div class="hr"></div><div id="speakerList"></div>
</div>

<div class="card full-width">
<h2>Publishers</h2><div class="hr"></div>
<input id="pubName" placeholder="Publisher Name">
<input type="file" id="pubLogo">
<button class="btn" onclick="addPublisher()">Add</button>
<div class="hr"></div><div id="publisherList"></div>
</div>

<div class="card full-width">
<h2>Partners</h2><div class="hr"></div>
<input id="partnerName" placeholder="Partner Name">
<input type="file" id="partnerLogo">
<button class="btn" onclick="addPartner()">Add</button>
<div class="hr"></div><div id="partnerList"></div>
</div>

</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC5Uq-o4ztdm5XPKmSXseqI7shiJBTpevA",
  authDomain: "trustnet-1-eac5e.firebaseapp.com",
  projectId: "trustnet-1-eac5e",
  storageBucket: "trustnet-1-eac5e.firebasestorage.app",
  messagingSenderId: "1004870765771",
  appId: "1:1004870765771:web:e32b513a5beaf0cd7e1f4e"
};

firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();
const storage = firebase.storage();

/* LOGIN CHECK */
if(sessionStorage.getItem("adminLoggedIn")!=="true"){
  location.href="login.html";
}
function logout(){
  sessionStorage.clear();
  location.href="pbl.html";
}

/* ========================= */
/* IMPORTANT DATES */
/* ========================= */

function addDate(){
  if(!eventName.value || !eventDate.value)
    return alert("Fill all fields");

  db.collection("dates").add({
    event:eventName.value,
    date:eventDate.value
  });

  eventName.value="";
  eventDate.value="";
}

db.collection("dates").onSnapshot(s=>{
  datesList.innerHTML="";
  s.forEach(d=>{
    datesList.innerHTML+=`
    <div class="simple-item">
      ${d.data().event} – ${d.data().date}
      <button class="btn-outline"
      onclick="db.collection('dates').doc('${d.id}').delete()">Delete</button>
    </div>`;
  });
});


/* ========================= */
/* SPEAKERS */
/* ========================= */

async function addSpeaker(){
  if(!spName.value || !spAff.value || !spImg.files[0])
    return alert("Fill all fields");

  const file = spImg.files[0];
  const ref = storage.ref("speakers/" + Date.now() + "_" + file.name);

  await ref.put(file);
  const url = await ref.getDownloadURL();

  await db.collection("speakers").add({
    name: spName.value,
    affiliation: spAff.value,
    image: url
  });

  spName.value="";
  spAff.value="";
  spImg.value="";
}


/* ========================= */
/* PUBLISHERS */
/* ========================= */

async function addPublisher(){
  if(!pubName.value || !pubLogo.files[0])
    return alert("Fill all fields");

  const file = pubLogo.files[0];
  const ref = storage.ref("publishers/" + Date.now() + "_" + file.name);

  await ref.put(file);
  const url = await ref.getDownloadURL();

  await db.collection("publishers").add({
    name: pubName.value,
    logo: url
  });

  pubName.value="";
  pubLogo.value="";
}


/* ========================= */
/* PARTNERS */
/* ========================= */

async function addPartner(){
  if(!partnerName.value || !partnerLogo.files[0])
    return alert("Fill all fields");

  const file = partnerLogo.files[0];
  const ref = storage.ref("partners/" + Date.now() + "_" + file.name);

  await ref.put(file);
  const url = await ref.getDownloadURL();

  await db.collection("partners").add({   // ✅ FIXED (was "partner")
    name: partnerName.value,
    logo: url
  });

  partnerName.value="";
  partnerLogo.value="";
}


/* ========================= */
/* LIVE LISTENERS */
/* ========================= */

db.collection("speakers").onSnapshot(s=>{
  speakerList.innerHTML="";
  s.forEach(d=>{
    speakerList.innerHTML+=`
    <div class="simple-item">
      ${d.data().name}
      <button class="btn-outline"
      onclick="db.collection('speakers').doc('${d.id}').delete()">Delete</button>
    </div>`;
  });
});

db.collection("publishers").onSnapshot(s=>{
  publisherList.innerHTML="";
  s.forEach(d=>{
    publisherList.innerHTML+=`
    <div class="simple-item">
      ${d.data().name}
      <button class="btn-outline"
      onclick="db.collection('publishers').doc('${d.id}').delete()">Delete</button>
    </div>`;
  });
});

db.collection("partners").onSnapshot(s=>{
  partnerList.innerHTML="";
  s.forEach(d=>{
    partnerList.innerHTML+=`
    <div class="simple-item">
      ${d.data().name}
      <button class="btn-outline"
      onclick="db.collection('partners').doc('${d.id}').delete()">Delete</button>
    </div>`;
  });
});

</script>

</body>
</html>
